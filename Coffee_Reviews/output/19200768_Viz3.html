<html>
   <head>
      <title> Karishma Tyagi - Assignment</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5.9.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@4.0.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.2.1"></script>
      <style>
         body {
         font-family: sans-serif;
         }
      </style>
   </head>
   <body>
      <table style="width: 850px;" cellspacing="5" cellpadding="5">
         <tbody>
            <tr>
               <td style="width: 200px; vertical-align: top;"><strong>Name:&nbsp;</strong></td>
               <td style="vertical-align: top;">Karishma Tyagi</td>
            </tr>
            <tr>
               <td style="vertical-align: top;"><strong>Student Number:</strong></td>
               <td style="vertical-align: top;">19200768</td>
            </tr>
            <tr>
               <td style="vertical-align: top;"><strong>Dataset description:</strong></td>
               <td style="vertical-align: top;"> <b>Arabica and Robusta Coffee Ratings </b><br>
               		<li>The Arabica Coffee Ratings and the Robusta Coffee Ratings datasets consists of the reviews from specialized reviewers for both coffees: Arabica and Robusta.</li> <br>
               		<li>For each dataset, various Quality Measures are given such as:</li> 
               			<ol>
               				<li><b>Aroma:</b> A distinctive, typically pleasant smell.</li>
               				<li><b>Flavor:</b> The distinctive taste of Coffee.</li>
               				<li><b>Aftertaste:</b> Remaining taste in the mouth after drinking Coffee.</li>
               				<li><b>Acidity:</b> Range of flavors perceived in coffee, attributed to acids in coffee beans.</li>
	               			<li><b>Body:</b>  The physical properties of the coffee, mouthfeel: Oily, Greasy,Watery</li>
	               			<li><b>Balance</b></li>
	               			<li><b>Uniformity:</b> The consistency in coffee beans.</li>
	               			<li><b>Cup Cleanliness</b></li>
	               			<li><b>Sweetness:</b> A mild,smooth coffee flavor taste sensation without any harsh tastes </li>
	               			<li><b>Moisture:</b> The moisture content in coffee beans.</li>
	               			<li><b>Defects and so on.</b></li>
               		 	</ol>

               		<li> Also the meta data related to the Bean comprises of:</li> 
               		<ol>
               			<li> <b>Processing Method:</b> The method used to produce Coffee.</li>
               			<li> <b>Color</b> The color of the coffee bean.</li>
               			<li> <b>Species</b>Different types of Coffee. (Arabica / Robusta).</li>

               		</ol>

               		<li> At last the location details where the coffee beans are grown such as:</li> 
               		<ol>
               			<li> <b>Owner:</b> One who owns the farms for the Coffee farming.</li>
               			<li> <b>Country of Origin:</b> Country where the coffee production takes place.</li>
               			<li> <b>Farm Name:</b> Actual farm where coffee grows.</li>
               			<li> <b>Lot Number:</b> It signifies the batch Number.</li>
               			<li> <b>Mill:</b> The storage Mill where the coffee is stored.</li>
               			<li> <b>Company:</b> Manufacturing company of Coffee.</li>
               			<li> <b>Altitude:</b> Heights at which Coffee farming is done.</li>
               			<li> <b>Region:</b> The specific region of country that grows Coffee.</li>
               		</ol>

               		<li> The data for both the types of Coffees is merged with all the common features. Pre-processing is done separately on both the datasets prior to merging.</li> <br>
               		<li> Out of all the features of coffee, a set of features are extracted and it consists of top five countries with their average coffee growth (kg), specific coffee species they grow, quality score, mean altitude (meters) at which the coffee growth is measured. </li>
               	
               </td>
            </tr>
            <tr>
               <td style="vertical-align: top;"><strong>Initial questions</strong></td>
               <td style="vertical-align: top;"> The initial questions for this plot were:<br>
                <br> 1.  The height and climate of the farm can impact the type of coffee a farmer may choose to plant. Farmers thus selects their coffee plant variety according to their climate, elevation they are at. It is apt to analyse now: How the coffee growth in any country varies over the altitude ?</br>
                <br> 2. Which country is capable of supporting coffee growth at maximum altitudes ? </br>
                <br> 3. Which is the mean altitude (in meters)optimum for mass coffee production ? </br>
                <br> 4. How much amount of coffee (in kgs) can be grown at various altitude levels and how their growth varies in the top five coffee growing countries ? </br>
                <br> 5. What is the mean altitude for countires to grow Coffee in bulk amount ? </br>
            </td>
            </tr>
         </tbody>
      </table>
      <hr />
      <div id="vis"></div>
      <hr />
      <table style="width: 850px;" cellspacing="5" cellpadding="5">
         <tbody>
            <tr>
               <td style="width: 200px; vertical-align: top;"><strong>Description:&nbsp;</strong></td>
               <td style="vertical-align: top;"> 
               	<br>A layered graph with the top five coffee growing countries along with their altitude and the amount of coffee grown in these countries is plotted over here. </br>
               	The above graph depicts a number of things: <br>
               	<ol>
               		<li> The first layer is about the highest coffee growing countries and their mean altitude (in meters) at which they grow coffee. Every single bar represents one country and every bar points to its mean altitude.</li> <br>
               		<li> The next layer is about the highest coffee growing countries and their mean coffee growth (in kgs) across all the years. Every mark on the line depicts the mean amount of coffee for each country listed at the X- axis. </li> <br>
               		<li> Both the layers combined together depicts the country with their mean altitude (in meters) and the amount of coffee (in kgs) they grow.  </li> 
               		
				</ol>
               	</td>
               	
            </tr>
            <tr>
               <td style="vertical-align: top;"><strong>Insights:</strong></td>
               <td style="vertical-align: top;">
               	<li> It is clearly evident from the graph that the altitude at which a bean is grown has an important role to play when it comes to the quality and the amount of beans produced.</li> <br>
               	<li> Higher altitude's cooler temperatures slow down the growth rate of the coffee plant and at a slower growth rate, the coffee plants focuses more on reproduction. Thus more energy can be invested by the the plants to bean production which in turn produces large amount of sugars required to create tasting notes in the coffee. </li> <br>
               	<li> Another insights that can be derived from this visualization is: Higher elevations too have better drainage than places at low level in the watershed. 
 					And if low amount of water is provided to the coffee bean, more concentrating flavors can be created by the sugars.</li> <br>
 				<li> Taiwan comes out to be at the least level with a mean altitude of 680 meters with a productioon of 571 kgs of Coffee. </li> <br>
 				<li> Gautenemala is the country which is capable of harvesting coffee at the maximum altitude of 3784 meters with a significant amount of 11970 kgs of coffee.</li> <br>
 				<li> Columbia proves to be an exception with low altitude of 1265 meters and maximum amount 14319 kgs of coffee produced.</li> <br>
               </td>
            </tr>
            <tr>
               <td style="vertical-align: top;"><strong>Design considerations</strong></td>
               <td style="vertical-align: top;"> <li> To consider the design of this plot, encodings for the X axis comprises of five countries producing massive amount of coffee, which is a nominal type of attribute. All the countries considered are not assumed, they are chosen after whole process of pre-processing with maximum value counts in the group.</li> <br>
               
               <li> And for the Y axis, 2 encodings are incorporated in the data using the layering functionality. </li> <br>
               <li> Using a repeat functionality, six different graphs for the trends of quality measures across the same years are plotted. </li>  <br>
               <li> For the Y-axis , all the quality measures under consideration are aggregated by both Median and mean operations.</li>  <br>
               <li> Further a 2 layered graph within each of the six graphs is displayed.</li>
               		<ol>
               			<li> The first layer within the graph is a bar graph pointing to the mean altitude values for countries. </li> <br>

               			<li> The second layer within the graph is a marked line graph displaying the average amount of coffee produced corresponding to the mean altitude of the country.</li>
               		</ol> <br>
               <li> Further two tooltips each for a Y-axis, one depicts the country with its corresponding Mean altitude value and other depicting the country with its corresponding amount of Coffee produced are provided.</li> <br>
               <li> Both the Y-axis encodings are color coded to clearly display both the aspects for every country.</li> <br>
               <li> The alternative designs tried earlier to this design were: <br>
               	<ol>
               		<li><b> A layered bar graph</b> For every country, 2 segments each of mean altitude and mean amount of coffee produced are taken as bar for both the Y-axis encodings.</li> 
               			Disadvantages: 
               			<ul>
               				<li> Both the bars were overlapping, hence it was difficult to read the values of Mean Altitude and Average amount of coffee produced for a country. </li>
               				<li> Even if changing the bar size doesn't make much difference. It is as good as two layered line graphs. </li>
               			</ul>

               		<li>Two layered Graph with both bar and line: </li>
               			Advantages: <br>
               			<ul>
               				<li> Line over bar layer are easy to read and to plot.</li>
               				<li> The marked points clearly depicts the amount of coffe produced corresponding to the year. </li>
               				<li> The color coded axis titles easily tells that bar corresponds to the mean altitude on one of the Y-axis and line corresponds to corresponding amount of coffee produced for a country.</li>
               			</ul>
               </ol>
           </td>
            </tr>
            <tr>
               <td style="width: 200px; vertical-align: top;"><strong>Data Filtering and Transformation:&nbsp;</strong></td>
               <td style="vertical-align: top;">
               	<li> In order to get the top five coffee growing countries, the initial dataset is grouped together on the basis of Country available.</li> <br>
               	<li> Further on the basis of their value counts, the five countries with maximum count of records are chosen. </li> <br>
               	<li> Within every group of country, only few of the attributes are considered, rest are dropped from the group.</li> <br>
               	<li> The considered attributes are: Coffee Species teh country produce, Quality_Score, Country_of_Origin, Number_of_Bags of coffee produced, Weight of each coffee bag produced, minimum elevation at which the coffee is grown (Min_Altitude), and maximum elevation at which the coffee can be grown (Max_Altitude)</li> <br>
				<li> There were inconsistencies among the weights of the coffee bags (Some were in lbs, few in kgs). Hence all the weights throughout the data are transformed in a single unit. </li> <br>
				<li> A copy of the Bag_Weight attribute is created in the dataset, and only the numerical value of weight is extracted from the Bag_Weight field (60 lb -> 60) using str.extract functioanlity of Python. </li><br>
				<li> Further iterating over all the rows and checking for the existence of the string 'lb' in the Copy field of Bag_Weight</li>
				<ol> 
					<li> If 'lb' exists in the copy of bag weight column: then the numeric value from the Bag_Weight is transformed in float type and multiplied with a factor of 0.45 in order to convert the weights in lb to kgs.</li>
				</ol>
               	<li> Further two calculated fields are computed. </li>
               	<ol> 
               		<li> Coffee_Growth field which is computed as the product of Number_of_Bags and the Bag_Weight for every group.</li>
               		<li> Mean_Altitude field which is computed as the average of Min_Altitude and Max_Altitude for every group.</li>
               	</ol>
               	<li> Now the required fields are Coffee_Growth, Mean_Altitude, Species, Country_of_Origin. So rest all attributes are removed from the dataset.</li> <br>
               	<li> Then for each group (i.e Country), the amount of Coffee_Growth, Quality_Score and the Altitude are averaged.</li> <br>

               	<li> Further one filter is incorporated in the data: </li> 
               		<ol> 
               			<li> A filter on the Mean_Altitude is considered allowing only the positive values of it.</li>
              		</ol>

               </td>
            </tr>
         </tbody>
      </table>
      <script type="text/javascript">
        var yourVlSpec =  {
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "data": {
    "url": "https://raw.githubusercontent.com/ktyagi12/Information_Visualizations/master/Arabica_Robusta_Coffee_Ratings/Country_Quality_Coffee_Growth_Chart.csv",
    "format": {
      "type": "csv"
    }
  },
  "title": {
    "text": "Top 5 Countries' Coffee Growth varying with Mean Altitude ",
    "anchor": "middle",
    "fontSize": 20
  },
  "config": {
    "axis": {
      "labelFontSize": 12,
      "titleFontSize": 14,
      "titlePadding": 8
    },
    "legend": {
      "orient": "right",
      "labelFontSize": 10,
      "padding": 3
    }
  },
  "transform": [
    {
      "filter": "datum.Mean_Altitude>0"
    }
  ],
  "width": 700,
  "height": 500,
  "encoding": {
    "x": {
      "field": "Country",
      "type": "nominal",
      "scale": {
        "zero": false
      },
      "axis": {
        "title": "Coffee producing Country",
        "titleFontSize": 14,
        "labelAngle": 0,
        "labelFontSize": 14
      }
    }
  },
  "layer": [
    {
      "mark": {
        "type": "bar",
        "tooltip": true,
        "color": "#16A085"
      },
      "encoding": {
        "y": {
          "field": "Mean_Altitude",
          "type": "quantitative",
          "scale": {
            "zero": false
          },
          "axis": {
            "title": "Mean Altitude (in meters)",
            "titleFontSize": 14,
            "titleColor": "#16A085",
            "labelAngle": 0,
            "labelFontSize": 12
          }
        },
        "size": {
          "value": 50
        }
      }
    },
    {
      "mark": {
        "type": "line",
        "interpolate": "monotone",
        "tooltip": true,
        "color": "purple",
        "point": true
      },
      "encoding": {
        "y": {
          "field": "Coffee_Growth",
          "type": "quantitative",
          "scale": {
            "zero": false
          },
          "axis": {
            "titlePadding": 8,
            "titleColor": "purple",
            "title": "Average Coffee (in Kgs)","titleFontSize": 14,
            "labelAngle": 0,
            "labelFontSize": 12,
            "labelPadding": 40
          }
        }
      }
    }
  ],
  "resolve": {
    "scale": {
      "y": "independent"
    }
  }
}
            vegaEmbed("#vis", yourVlSpec);
      </script>
   </body>
</html>